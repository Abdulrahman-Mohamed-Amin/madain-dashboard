<section class="page">

  <!-- Project Header -->
  <header class="project-header mt-4">

    <!-- RIGHT: Project Info -->
    <div class="ph-right">

      <div class="breadcrumbs">
        <span>ููุญุฉ ุงูุชุญูู</span>
        <span class="dot">โข</span>
        <span>ุงููุดุงุฑูุน</span>
        <span class="dot">โข</span>
        <span class="current">ุชูุงุตูู ุงููุดุฑูุน</span>
      </div>

      <h1 class="project-title">{{ project?.arTitle }}</h1>
      <p class="project-desc">{{ project?.arDescription }}</p>

      <!-- Project Meta -->
      <div class="project-meta">

        <div class="meta-grid">

          <div class="meta-card">
            <div class="m-label">ุงููููุน</div>
            <div class="m-value">{{ project?.arLocationName }}</div>
            @if (project?.locationUrl) {
            <a class="m-link" [href]="project?.locationUrl" target="_blank">
              ุนุฑุถ ุนูู ุงูุฎุฑูุทุฉ โ
            </a>
            }
          </div>


          <div class="meta-card">
            <div class="m-label">ุชุตููู ุงููุดุฑูุน</div>
            <div class="m-value">{{ project?.arProjectCategory }}</div>
          </div>

          <div class="meta-card">
            <div class="m-label">ูุณุงุญุฉ ุงููุณุทุญุงุช</div>
            <div class="m-value">{{ project?.surfaceArea }} ูยฒ</div>
          </div>

          <div class="meta-card">
            <div class="m-label">ูุณุงุญุฉ ุงูุฃุฑุถ</div>
            <div class="m-value">{{ project?.groundArea }} ูยฒ</div>
          </div>
          <div class="meta-card">
            <div class="m-label">ุนุฏุฏ ุงููุจุงูู</div>
            <div class="m-value">{{ project?.buildings?.length || 0 }} </div>
          </div>
          <div class="meta-card">
            <div class="m-label">ุงุฌูุงูู ุงููุญุฏุงุช</div>
            <div class="m-value">{{ project?.unitsCount || 0 }} </div>
          </div>

        </div>
      </div>


      <!-- Actions -->
      <div class="header-actions mt-3">
        <button class="btn btn-primary" type="button" [routerLink]="['/dashboard/add_build' , project?.id]">
          + ุฅุถุงูุฉ ูุจูู
        </button>
        <button class="btn btn-ghost" type="button" [routerLink]="['/dashboard/edit_project' , project?.id]">
          ุชุนุฏูู ุงููุดุฑูุน
        </button>
        <button class="btn btn-ghost danger" type="button" (click)="deleteProject()">
          ุญุฐู ุงููุดุฑูุน
        </button>
      </div>

    </div>

    <!-- LEFT: Media -->
    <div class="ph-left">

      <div class="media-card">

        <!-- Facade -->
        <div class="media-hero">
          @if (project?.interfaceImagePath) {
          <img [src]="url + project?.interfaceImagePath" alt="ูุงุฌูุฉ ุงููุดุฑูุน" />
          <span class="media-badge">ูุงุฌูุฉ ุงููุดุฑูุน</span>
          } @else {
          <div class="media-empty">
            <span class="icon">๐ข</span>
            <span>ูุง ุชูุฌุฏ ุตูุฑุฉ ูุงุฌูุฉ</span>
          </div>
          }
        </div>

        <!-- Gallery -->
        <div class="thumbs">
          <div class="thumbs-head">
            <div class="thumbs-title">ุตูุฑ ุงููุดุฑูุน</div>
            <div class="thumbs-count">{{ project?.projectImages?.length || 0 }}</div>
          </div>

          @if (project?.projectImages?.length) {
          <div class="thumbs-row">
            @for (img of project?.projectImages; track $index) {
            <div class="thumb">
              <img [src]="url + img" alt="ุตูุฑุฉ ุงููุดุฑูุน" />
            </div>
            }
          </div>
          } @else {
          <div class="thumbs-empty">
            <span>๐ผ๏ธ ูุง ุชูุฌุฏ ุตูุฑ</span>
          </div>
          }
        </div>

      </div>

    </div>

  </header>



  <!-- Buildings -->
  <section class="buildings">
    <div class="section-head mt-4 pe-3">
      <h2 class="section-title">ุงููุจุงูู ูุงููุญุฏุงุช</h2>
    </div>

    @if (project?.buildings?.length) {

    <!-- Building Card -->
    @for (b of project?.buildings; track b.id) {
    <article class="building-card mb-4">

      <!-- Building Top -->

      <div class="building-top">
        <div class="b-meta">
          <div class="b-badge">ูุจูู</div>
          <div class="b-text">
            <h3 class="b-title">{{ b.arTitle }}</h3>
            <p class="b-sub">
              <span class="k">ุงููุดุฑูุน:</span>
              <span class="v">{{ project?.arTitle }}</span>
            </p>
          </div>
        </div>

        <div class="b-actions">
          <button class="btn btn-primary " type="button" title="ุชุนุฏูู"
            [routerLink]="['/dashboard/edit_build' , b.id]">โ</button>
          <button class="btn btn-ghost danger" type="button" title="ุญุฐู"><i class="fas fa-trash"
              (click)="deleteBuilding(b.id)"></i></button>
        </div>
      </div>

      <!-- Units -->
      <div class="units-wrap">

        <div class="units-head">
          <div class="uh-left">
            <h4 class="units-title">ุงููุญุฏุงุช</h4>
            <span class="units-count">
              {{ b.units.length }} ูุญุฏุฉ
            </span>
          </div>

          <button class="btn btn-soft" type="button" [routerLink]="['/dashboard/add_unit' , b.id]">+ ุฅุถุงูุฉ ูุญุฏุฉ</button>
        </div>

        @if (b.units.length) {
        <div class="units-grid">
          @for (u of b.units; track u.id) {
          <article class="unit-card">
            <div class="unit-top">
              <div class="u-name">
                <span class="u-label">ูุญุฏุฉ</span>
                <h5 class="u-title">{{ u.arTitle }}</h5>
              </div>

              <span class="pill" [class.sold]="u.isSealed">
                {{ u.isSealed ? 'ูุจุงุนุฉ' : 'ูุชุงุญุฉ' }}
              </span>
            </div>

            <div class="unit-body">
              <p class="u-desc">{{ u.arDescription }}</p>

              <div class="u-info">
                <div class="info">
                  <span class="k">ุงูุฏูุฑ</span>
                  <span class="v">{{ u.floor }}</span>
                </div>
                <div class="info">
                  <span class="k">ุงููุณุงุญุฉ</span>
                  <span class="v">{{ u.area }} ูยฒ</span>
                </div>
                <div class="info">
                  <span class="k">ุงูุณุนุฑ</span>
                  <span class="v price">{{ u.price | number:'1.0-0' }}</span>
                </div>
              </div>
            </div>

            <div class="unit-actions d-flex gap-2">
             <button [routerLink]="['/dashboard/edit_unit', u.id, b.id]" class="btn btn-primary">
                ุชุนุฏูู
                </button>
                <button class="btn btn-danger sm" type="button" (click)="deleteUnit(u.id)">ุญุฐู</button>
            </div>
          </article>
          }
        </div>
        } @else {
        <div class="empty">
          <div class="empty-icon">๐ฆ</div>
          <div class="empty-title">ูุง ุชูุฌุฏ ูุญุฏุงุช ุฏุงุฎู ูุฐุง ุงููุจูู</div>
          <div class="empty-desc">ุงุจุฏุฃ ุจุฅุถุงูุฉ ูุญุฏุฉ ุฌุฏูุฏุฉ ูุนุฑุถูุง ููุง.</div>
          <button class="btn btn-primary" type="button" [routerLink]="['/dashboard/add_unit' , b.id]">+ ุฅุถุงูุฉ
            ูุญุฏุฉ</button>
        </div>
        }

      </div>
    </article>
    }

    } @else {
    <div class="empty big">
      <div class="empty-icon">๐</div>
      <div class="empty-title">ูุง ุชูุฌุฏ ูุจุงูู ูู ูุฐุง ุงููุดุฑูุน</div>
      <div class="empty-desc">ุฃุถู ุฃูู ูุจูู ุนุดุงู ุชุจุฏุฃ ุฅุฏุงุฑุฉ ุงููุญุฏุงุช ุจุณูููุฉ.</div>
      <button class="btn btn-primary" type="button" [routerLink]="['/dashboard/add_build' , project?.id]">+ ุฅุถุงูุฉ
        ูุจูู</button>
    </div>
    }

  </section>
</section>